<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة الأداء الوظيفي</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background: #F8FAFC; color: #1B4D3E; }
        .header { background: linear-gradient(135deg, #00855D, #006B4A, #1B4D3E); color: white; padding: 20px 30px; display: flex; justify-content: space-between; align-items: center; }
        .container { max-width: 1400px; margin: 0 auto; padding: 30px; }
        .upload-card { background: white; border: 2px dashed #00855D; border-radius: 16px; padding: 50px; text-align: center; margin-bottom: 30px; cursor: pointer; }
        .upload-card:hover { border-color: #006B4A; }
        .upload-card i { font-size: 50px; color: #00855D; margin-bottom: 15px; }
        .stats-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; border-radius: 16px; padding: 25px; text-align: center; box-shadow: 0 4px 15px rgba(0,133,93,0.1); }
        .stat-card::before { content: ''; display: block; height: 4px; background: #00855D; border-radius: 16px 16px 0 0; margin: -25px -25px 20px; }
        .stat-card .value { font-size: 30px; font-weight: bold; color: #00855D; }
        .stat-card .label { color: #4A5D56; margin-top: 5px; }
        .section-card { background: white; border-radius: 16px; padding: 25px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,133,93,0.1); }
        .section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #E8F5E9; }
        .section-header i { color: #00855D; font-size: 20px; }
        .charts-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .chart-box { background: #F8FAFC; border-radius: 12px; padding: 20px; border: 1px solid #D4E5DD; }
        .footer { background: #1B4D3E; color: white; padding: 25px; text-align: center; }
        .btn { padding: 12px 24px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; }
        .btn-primary { background: #00855D; color: white; }
        .btn-secondary { background: #E8F5E9; color: #1B4D3E; }
        #loadingScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        #loadingScreen.active { display: flex; }
        .loading-spinner { width: 60px; height: 60px; border: 5px solid #E8F5E9; border-top: 5px solid #00855D; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        #error-banner { position: fixed; top: 100px; right: 20px; background: white; border-right: 4px solid #E53935; padding: 15px 20px; border-radius: 10px; display: none; z-index: 1000; box-shadow: 0 8px 30px rgba(0,0,0,0.15); }
        #error-banner.visible { display: block; }
        @media (max-width: 768px) { .charts-grid { grid-template-columns: 1fr; } .stats-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="loadingScreen"><div class="loading-spinner"></div><div class="loading-text" id="loadingText">جاري المعالجة...</div><div class="loading-subtext" id="loadingSubtext">يرجى الانتظار</div></div>
    <div id="error-banner"></div>
    <header class="header">
        <div style="display: flex; align-items: center; gap: 15px;">
            <i class="fas fa-graduation-cap" style="font-size: 30px;"></i>
            <div><h1>منظومة إدارة الأداء الوظيفي</h1><div style="font-size: 12px; opacity: 0.9;">وزارة التعليم - المملكة العربية السعودية</div></div>
        </div>
        <button class="btn btn-secondary" id="clear-data" style="background: rgba(255,255,255,0.2); color: white;"><i class="fas fa-trash-alt"></i> مسح البيانات</button>
    </header>
    <div class="container">
        <div class="section-card" style="text-align: center;">
            <h2 style="color: #00855D; margin-bottom: 10px;">لوحة متابعة الأداء الوظيفي</h2>
            <p style="color: #4A5D56;">تحليل وتقييم بيانات الأداء الوظيفي للموظفين</p>
        </div>
        <div class="upload-card" onclick="document.getElementById('excel-file').click()">
            <i class="fas fa-cloud-upload-alt"></i>
            <h3>رفع ملف بيانات الأداء</h3>
            <p>يمكنك رفع ملفات Excel (.xlsx, .xls)</p>
            <span style="display: inline-block; margin-top: 10px; padding: 8px 20px; background: #00855D; color: white; border-radius: 20px; font-weight: 600;">اضغط للرفع</span>
            <input type="file" id="excel-file" accept=".xlsx,.xls" style="display: none;">
        </div>
        <div class="stats-container" id="statsSection" style="display: none;">
            <div class="stat-card"><div class="value" id="total-records">-</div><div class="label">إجمالي السجلات</div></div>
            <div class="stat-card"><div class="value" id="valid-ratings">-</div><div class="label">تقييمات صالحة</div></div>
            <div class="stat-card"><div class="value" id="avg-rating">-</div><div class="label">متوسط التقييم</div></div>
        </div>
        <div class="section-card" id="filtersSection" style="display: none;">
            <div class="section-header"><i class="fas fa-filter"></i><h3>فلاتر البحث</h3></div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #1B4D3E;"><i class="fas fa-map-marker-alt"></i> المنطقة</label>
                    <select id="filter-region-main" style="width: 100%; padding: 10px; border: 2px solid #D4E5DD; border-radius: 8px; font-family: 'Cairo', sans-serif;"><option value="">جميع المناطق</option></select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #1B4D3E;"><i class="fas fa-building"></i> الإدارة</label>
                    <select id="filter-department" style="width: 100%; padding: 10px; border: 2px solid #D4E5DD; border-radius: 8px; font-family: 'Cairo', sans-serif;"><option value="">الكل</option></select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #1B4D3E;"><i class="fas fa-star"></i> نطاق التقييم</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="number" id="filter-rating-min" min="0" max="5" step="0.1" placeholder="من" style="width: 80px; padding: 10px; border: 2px solid #D4E5DD; border-radius: 8px; text-align: center;">
                        <span>-</span>
                        <input type="number" id="filter-rating-max" min="0" max="5" step="0.1" placeholder="إلى" style="width: 80px; padding: 10px; border: 2px solid #D4E5DD; border-radius: 8px; text-align: center;">
                    </div>
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-primary" id="apply-filters"><i class="fas fa-search"></i> تطبيق</button>
                <button class="btn btn-secondary" id="reset-filters"><i class="fas fa-redo"></i> إعادة تعيين</button>
            </div>
        </div>
        <div class="section-card" id="chartsSection" style="display: none;">
            <div class="section-header"><i class="fas fa-chart-pie"></i><h3>التحليل الإحصائي</h3></div>
            <div class="charts-grid">
                <div class="chart-box"><h4>أفضل الإدارات أداءً</h4><canvas id="departmentsChart"></canvas></div>
                <div class="chart-box"><h4>توزيع التقييمات</h4><canvas id="ratingsDistribution"></canvas></div>
                <div class="chart-box"><h4>عدد الموظفين</h4><canvas id="employeesByDept"></canvas></div>
                <div class="chart-box"><h4>مقارنة الأداء</h4><canvas id="performanceComparison"></canvas></div>
            </div>
        </div>
        <div class="section-card" id="citiesChartSection" style="display: none;">
            <div class="section-header"><i class="fas fa-city"></i><h3>أداء المدن</h3></div>
            <canvas id="citiesChart"></canvas>
        </div>
    </div>
    <footer class="footer"><p>© 1446هـ - 2025م وزارة التعليم - المملكة العربية السعودية</p></footer>
    <script src="script.js"></script>
</body>
</html>

